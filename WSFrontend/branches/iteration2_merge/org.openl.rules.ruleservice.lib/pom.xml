<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>org.openl.rules</groupId>
    <artifactId>org.openl.rules.ruleservice-pom</artifactId>
    <version>5.2.0-SNAPSHOT</version>
    <relativePath>../org.openl.rules.ruleservice-pom</relativePath>
  </parent>

  <artifactId>org.openl.rules.ruleservice.lib</artifactId>
  <name>OpenL - RuleService - Libraries</name>
  <description />

  <dependencies>
    <dependency>
      <groupId>org.openl.rules</groupId>
      <artifactId>org.openl.rules.ruleservice</artifactId>
      <version>${version}</version>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <version>1.1</version>
        <configuration>
          <tasks>
            <delete includeemptydirs="true" failonerror="false">
              <fileset dir="lib" includes="**/*" />
            </delete>

            <typedef resource="org/apache/maven/artifact/ant/antlib.xml">
              <classpath refid="maven.dependency.classpath"/>
            </typedef>
            <pom id="maven.project" file="pom.xml"/>
            <dependencies filesetid="dependency.fileset" usescope="runtime">
              <pom refid="maven.project"/>
            </dependencies>

            <copy todir="target/deps" flatten="true">
              <fileset refid="dependency.fileset"/>
            </copy>

            <copy todir="lib" flatten="true">
              <fileset dir="target/deps">
                <exclude name="org.openl*" />
                <exclude name="acegi*" />
                <exclude name="commons*" />
                <exclude name="activation*" />

                <exclude name="oro-*" />
                <exclude name="poi-*" />
                <exclude name="spring-2.5.*" />

                <exclude name="junit*" />
                <exclude name="dbunit*" />
                <exclude name="hsqldb*" />

                <exclude name="jackrabbit*" />
                <exclude name="jcr*" />
                <exclude name="derby*" />
                <exclude name="lucene*" />
                <exclude name="xercesImpl*" />
                <exclude name="xml-apis*" />
                <exclude name="xmlParserAPI*" />

                <exclude name="slf4j-api*" />
                <exclude name="slf4j-log4j*" />
                <exclude name="log4j*" />
                <exclude name="logkit*" />

                <exclude name="concurrent*" />
                <exclude name="avalon*" />
                <exclude name="spring-web*" />
                <exclude name="jsf*" />
                <exclude name="el-api*" />
                <exclude name="myfaces*" />
              </fileset>
            </copy>

            <delete dir="target/deps"/>
          </tasks>
        </configuration>
        <dependencies>
          <dependency>
            <groupId>org.apache.maven</groupId>
            <artifactId>maven-artifact-ant</artifactId>
            <version>2.0.4</version>
          </dependency>
        </dependencies>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <configuration>
          <outputDirectory>${project.build.directory}/../lib</outputDirectory>
          <excludeGroupIds>com.exigen.rules,org.openl,org.openl.rules,org.acegisecurity,org.apache.jackrabbit</excludeGroupIds>
          <excludeArtifactIds>junit,dbunit,commons-beanutils,commons-codec,commons-collections,commons-digester,commons-el,commons-fileupload,commons-io,commons-lang,commons-logging</excludeArtifactIds>
          <overWriteReleases>true</overWriteReleases>
          <overWriteSnapshots>true</overWriteSnapshots>
          <type>jar</type>
        </configuration>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jar-plugin</artifactId>
        <configuration>
          <archive>
            <manifestFile>META-INF/MANIFEST.MF</manifestFile>
          </archive>
        </configuration>
      </plugin>
    </plugins>
  </build>

</project>