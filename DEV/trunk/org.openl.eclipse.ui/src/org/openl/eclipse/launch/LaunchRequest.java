/*
 * Created on Sep 18, 2003
 *
 * Developed by OpenRules Inc. 2003
 */

package org.openl.eclipse.launch;

import org.eclipse.core.resources.IResource;
import org.eclipse.jface.viewers.IStructuredSelection;
import org.eclipse.ui.IEditorPart;
import org.openl.eclipse.util.ResourceTreeAdaptor;
import org.openl.util.IOpenIterator;
import org.openl.util.OpenIterator;
import org.openl.util.TreeIterator;

/**
 * 
 * @author sam
 */
public class LaunchRequest extends LaunchBase implements ILaunchRequest
{
  protected Object[] selection;

  protected String mode;

  public LaunchRequest(IStructuredSelection selection, String mode)
  {
    this.selection = selection.toArray();
    this.mode = mode;
  }

  public LaunchRequest(IEditorPart editor, String mode)
  {
    this.selection = new Object[] { editor };
    this.mode = mode;
  }

  public String getLaunchMode()
  {
    return mode;
  }

  public boolean isFromEditor()
  {
    return selection.length > 0 && selection[0] instanceof IEditorPart;
  }

  public IOpenIterator getSelection()
  {
    IOpenIterator result = OpenIterator.EMPTY;

    for (int i = 0; i < selection.length; i++)
    {
      IResource resource = getResourceAdapter(selection[i]);
      if (resource != null)
        result = result.append(new TreeIterator(resource, new ResourceTreeAdaptor(),
                TreeIterator.DEFAULT));
    }

    return result;
  }

}
