<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
    xmlns:rich="http://richfaces.ajax4jsf.org/rich"
    template="/facelets/common/webstudioBase.xhtml">
    <ui:define name="page">
        <h:messages errorClass="error" infoStyle="color:green" />

        <h:form id="copyTableForm">

            <h2>Enter new table name</h2>
            <h:panelGrid columns="2">
                <h:outputText value="Business Name" />
                <h:inputText value="#{tableCopier.tableBusinessName}" />
                <h:outputText value="Technical Name" />
                <h:inputText value="#{tableCopier.tableTechnicalName}" />
            </h:panelGrid>
 
            <br />

            <h2>Select destination</h2>
            <fieldset>
                <legend>Workbook</legend>
                <a4j:region>
                    <h:selectOneMenu value="#{tableCopier.workbook}">
                        <a4j:support event="onchange" reRender="sheet"
                            ajaxSingle="true" oncomplete="updateControls()" />
                        <f:selectItems value="#{tableCopier.workbooks}" />
                    </h:selectOneMenu>
                </a4j:region>
                <br />
            </fieldset>

            <fieldset>
                <legend>Worksheet</legend>
                <h:panelGrid columns="2">
                    <h:selectOneRadio id="newSheet"
                        onclick="updateControls()"
                        value="#{tableCopier.newWorksheet}"
                        layout="pageDirection">
                        <f:selectItem itemValue="existing"
                            itemLabel="Existing" />
                        <f:selectItem itemValue="new" itemLabel="New" />
                    </h:selectOneRadio>
                    <h:panelGrid columns="1">
                        <h:selectOneMenu
                            value="#{tableCopier.worksheetIndex}" id="sheet">
                            <f:selectItems value="#{tableCopier.worksheets}" />
                        </h:selectOneMenu>
                        <h:inputText value="#{tableCopier.newWorksheetName}"
                            id="newSheetName" />
                    </h:panelGrid>
                </h:panelGrid>
            </fieldset>

            <hr />
            <h:commandButton value="Copy" action="#{tableCopier.copy}" />
        </h:form>

        <f:verbatim>
            <script type="text/javascript">
              function updateControls() {
                var e = document.forms['copyTableForm']['copyTableForm:newSheet'][0];
                var newSheet = e.value == 'new' ? e.checked : !e.checked;
                $('copyTableForm:sheet').disabled = newSheet;
                $('copyTableForm:newSheetName').disabled = !newSheet;
              }
     
              function enableControls() {
                $('copyTableForm:sheet').disabled = false;
                $('copyTableForm:newSheetName').disabled = false;
              }

              updateControls();
            </script>
        </f:verbatim>

    </ui:define>
</ui:composition>
