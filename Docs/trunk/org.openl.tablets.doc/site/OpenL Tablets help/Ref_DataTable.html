
<html>

  <head>
    <link href="Exigenstyle.css" rel="stylesheet" type="text/css">

    <title>
Data Table
    </title>

    <script>
var file_name="Ref_DataTable.html"
    </script>

  </head>

  <body>

    <h3>
<a name="data_table29"></a><a name="_Data_Table"></a>Data Table
    </h3>
 

    <p class="MsoBodyText">
A <b>data table</b> contains relational data that can be referenced from other tables
within
OpenL Tablets. In addition, information in data tables can be accessed from Java code
through wrappers as Java arrays. Data tables can contain Java classes or
OpenL Tablets data types. For information on data types, see <a href="Ref_DataTypeTable.html#_Data_Type_Table">Data Type Table</a>.
    </p>
 

    <p class="MsoBodyText">
The following topics are included in this section:
    </p>
 

    <ul>
      <li>

        <p>
<a href="Ref_DataTable.html#_Using_Simple_Data">Using Simple Data Tables</a>
        </p>

      </li>
      <li>

        <p>
<a href="Ref_DataTable.html#_Using_Advanced_Data">Using Advanced Data Tables</a>
        </p>

      </li>
      <li>

        <p>
<a href="Ref_DataTable.html#_Ensuring_Data_Integrity">Ensuring Data Integrity</a>
        </p>

      </li>
      <li>

        <p>
<a href="Ref_DataTable.html#_Specifying_Data_for">Specifying Data for Aggregated Objects</a>
        </p>

      </li>
    </ul>
    

    <h4>
<a name="using_simple_data_tables30"></a><a name="_Using_Simple_Data"></a>Using Simple Data Tables
    </h4>
 

    <p class="MsoBodyText">
The following is an example of a data table containing a simple array of
numbers:
    </p>
 

    <div>
<img border=0 hspace=1 src="images/Ref_image017.gif">
    </div>
 

    <p class="MsoBodyText">
The first row is the header containing text in the following format:
    </p>
 

    <p class="MsoBodyText">
<code>Data &lt;data table type&gt; &lt;data table name&gt;</code>
    </p>
 

    <p class="MsoBodyText">
In simple data tables, the keyword 'this' must be used for the following
types:
    </p>
 

    <ul>
      <li>

        <p>
all primitive Java types
        </p>

      </li>
      <li>

        <p>
class <code>java.lang.String</code>
        </p>

      </li>
      <li>

        <p>
class <code>java.util.Date</code>
        </p>

      </li>
      <li>

        <p>
all Java classes with a public constructor with a single String
parameter
        </p>

      </li>
    </ul>
    

    <p class="MsoBodyText">
In the example above, information in the data table can be accessed from
Java code as shown in the following code
example:
    </p>
 

    <p class="codelines">
<span class="GramE">int[</span>] num = tableWrapper.getNumbers();
    </p>
  

    <p class="codelines">
<span class="GramE">for</span> (int i = 0; i &lt; num.length; i++) {
    </p>
 

    <p class="codelines">
<span class="GramE">System.out.println(</span>num[i]);
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="MsoBodyText">
<span class="GramE">where</span> <code>tableWrapper</code> is an instance of the wrapper class of the Excel or Word file. For
information on wrappers, see
<a href="Ref_Wrappers.html#_Wrappers">Wrappers</a>.
    </p>
 

    <h4>
<a name="using_advanced_data_tables31"></a><a name="_Using_Data_Types"></a><a name="_Using_Advanced_Data"></a>Using Advanced Data Tables
    </h4>
 

    <p class="MsoBodyText">
Advanced data tables are used for storing information for complex
constructions, such as Java beans and data types. For information on
data types, see
<a href="Ref_DataTypeTable.html#_Data_Type_Table">Data Type Table</a>.
    </p>
 

    <p class="MsoBodyText">
The first row of an advanced data table contains text in the following
format:
    </p>
 

    <p class="MsoBodyText">
<code>Data &lt;Java bean or data type&gt; &lt;data table name&gt;</code>
    </p>
 

    <p class="MsoBodyText">
Each cell in the second row contains an attribute name of the data type
or Java bean. Normally, the second row is hidden to business
users.
    </p>
 

    <p class="MsoBodyText">
The third row contains attribute display names. Each row starting with
the fourth one contains values for specific data type
instances.
    </p>
 

    <p class="MsoBodyText">
The following diagram shows a data type table and a corresponding data
table with concrete values below
it:
    </p>
 

    <div>
<img border=0 hspace=1 src="images/Ref_image018.gif">
    </div>
 

    <p class="MsoBodyText">
Data tables can use Java beans instead of data types. For example,
instead of using a data type table Person, a developer can use the
following Java
bean:
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> class Person {
    </p>
  

    <p class="codelines">
String name;
    </p>
 

    <p class="codelines">
String ssn;
    </p>
  

    <p class="codelines">
<span class="GramE">public</span> String getName() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> name;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setName(String name) {
    </p>
 

    <p class="codelines">
this.name = name;
    </p>
 

    <p class="codelines">
}
    </p>
  

    <p class="codelines">
<span class="GramE">public</span> String getSsn() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> ssn;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setSsn(String ssn) {
    </p>
 

    <p class="codelines">
this.ssn = ssn;
    </p>
 

    <p class="codelines">
}
    </p>
  

    <p class="codelines">
}
    </p>
 

    <p class="MsoBodyText">
If a Java bean is used, to avoid compilation error, the package where
the Java bean is located must be imported using a configuration table as
described in
<a href="Ref_ConfigurationTable.html#_Configuration_Table">Configuration Table</a>.
    </p>
 

    <p class="MsoBodyText">
In Java code, the data table <code>p1</code> can be accessed as follows:
    </p>
 

    <p class="codelines">
<span class="GramE">Person[</span>] persArr = tableWrapper.getP1();
    </p>
  

    <p class="codelines">
<span class="GramE">for</span> (int i = 0; i &lt; persArr.length; i++) {
    </p>
 

    <p class="codelines">
<span class="GramE">System.out.println(</span>persArr[i].getName() + ' ' + persArr[i].getSsn());
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="MsoBodyText">
<span class="GramE">where</span> <code>tableWrapper</code> is an instance of the Excel or Word file wrapper. For information on
wrappers, see
<a href="Ref_Wrappers.html#_Wrappers">Wrappers</a>.
    </p>
 

    <h4>
<a name="ensuring_data_integrity32"></a><a name="_Ensuring_Data_Integrity"></a>Ensuring Data Integrity
    </h4>
 

    <p class="MsoBodyText">
If a data table contains values defined in another data table, it is
important to specify this relationship so that
OpenL Tablets can check data integrity during compilation. The relationship between
two data tables is defined using foreign keys, a concept that is used in
database management systems. Reference to another data table must be
specified in an additional row below the row where attribute names are
entered. The following format must be
used:
    </p>
 

    <p class="MsoBodyText">
<code>&gt; &lt;referenced data table name&gt; &lt;column name of the
referenced data
table&gt;</code>
    </p>
 

    <p class="MsoNormal">
In the following diagram, the data table <span class="GramE"><b>cities</b> contains</span> values from the table <b>states.</b> To ensure users enter correct values, a reference to the <b>code</b> column in the <b>states</b> table is defined.
    </p>
 

    <div>
<img border=0 hspace=1 src="images/Ref_image019.gif">
    </div>
 

    <p class="MsoBodyText">
In case user enters invalid state abbreviation in the table <b>cities,</b> OpenL Tablets reports an error.
    </p>
 

    <p class="MsoBodyText">
The target column does not have to be specified if it is the first
column in the referenced data table. For example, if a reference was
made to the column
<b>name</b> in the table <b>states,</b> the following simplified reference could be used:
    </p>
 

    <p class="MsoBodyText">
<code>&gt;states</code>
    </p>
 

    <p class="Note">
<b>Note: </b>To ensure users enter correct values, cell data validation lists can be
used in Excel limiting the range of values users can type
in.
    </p>
 

    <h4>
<a name="specifying_data_for_aggregated_objects33"></a><a name="_Specifying_Data_for"></a>Specifying Data for Aggregated Objects
    </h4>
 

    <p class="MsoBodyText">
Data tables can be used to specify attributes of referenced objects. An
object referenced by a data table is called an
<b>aggregated object.</b> To specify an attribute of an aggregated object, the following format
must be used in the row containing data table attribute
names:
    </p>
 

    <p class="MsoBodyText">
<code>&lt;<span class="GramE">name</span> of reference to the aggregated object&gt;.&lt;object attribute&gt;</code>
    </p>
 

    <p class="MsoBodyText">
To illustrate this approach, assume there are two Java classes <code>ZipCode</code> and <code>Address</code> defined:
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> class ZipCode {
    </p>
  

    <p class="codelines">
String zip1; // 5-digit part - mandatory
    </p>
 

    <p class="codelines">
String zip2; // 4-digit part - optional
    </p>
  

    <p class="codelines">
<span class="GramE">public</span> String getZip1() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> zip1;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setZip1(String zip1) {
    </p>
 

    <p class="codelines">
this.zip1 = zip1;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> String getZip2() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> zip2;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setZip2(String zip2) {
    </p>
 

    <p class="codelines">
this.zip2 = zip2;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
}
    </p>
  

    <p class="codelines">
<span class="GramE">public</span> class Address {
    </p>
 

    <p class="codelines">
String <span class="GramE">street</span>;
    </p>
 

    <p class="codelines">
String city;
    </p>
 

    <p class="codelines">
ZipCode zip;
    </p>
  

    <p class="codelines">
<span class="GramE">public</span> String getCity() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> city;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setCity(String city) {
    </p>
 

    <p class="codelines">
this.city = city;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> String getStreet() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> street;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setStreet(String street) {
    </p>
 

    <p class="codelines">
this.street = street;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> ZipCode getZip() {
    </p>
 

    <p class="codelines">
<span class="GramE">return</span> zip;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
<span class="GramE">public</span> void setZip(ZipCode zip) {
    </p>
 

    <p class="codelines">
this.zip = zip;
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="codelines">
}
    </p>
 

    <p class="MsoBodyText">
As can be seen from the code, the <code>Address</code> class contains a reference to the <code>ZipCode</code> class. A data table can be created that specifies values for both
classes at the same time, for
example:
    </p>
 

    <div>
<img border=0 hspace=1 src="images/Ref_image020.gif">
    </div>
 

    <p class="MsoBodyText">
In the preceding example, columns <b>Zip1</b> and <b>Zip2</b> contain values for class <code>ZipCode</code> referenced by class <code>Address</code>.
    </p>
 

    <p class="MsoBodyText">
All Java classes referenced in a data table must be imported using a
configuration table as described in
<a href="Ref_ConfigurationTable.html#_Configuration_Table">Configuration Table</a>.
    </p>
 

    <p class="Note">
<b>Note:</b> The reference path can be of any arbitrary depth, for example <code>account.person.address.street</code>.
    </p>
 <br clear="all">
  </body>
</html>
