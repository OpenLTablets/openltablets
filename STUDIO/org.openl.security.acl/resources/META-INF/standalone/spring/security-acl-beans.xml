<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <import resource="classpath:META-INF/standalone/spring/security-hibernate-beans.xml"/>

    <bean id="aclService" class="org.springframework.security.acls.jdbc.JdbcMutableAclService">
        <constructor-arg name="dataSource" ref="openlDataSource"/>
        <constructor-arg name="aclCache" ref="aclCache"/>
        <constructor-arg name="lookupStrategy" ref="aclLookupStrategy"/>
    </bean>

    <bean id="aclLookupStrategy" class="org.springframework.security.acls.jdbc.BasicLookupStrategy">
        <constructor-arg name="dataSource" ref="openlDataSource"/>
        <constructor-arg name="aclCache" ref="aclCache"/>
        <constructor-arg name="aclAuthorizationStrategy" ref="aclAuthorizationStrategy"/>
        <constructor-arg name="auditLogger" ref="aclAuditLogger"/>
    </bean>

    <bean id="aclAuditLogger" class="org.springframework.security.acls.domain.ConsoleAuditLogger" scope="prototype"/>

    <bean id="aclAuthorizationStrategy" class="org.springframework.security.acls.domain.AclAuthorizationStrategyImpl">
        <constructor-arg name="auths" ref="aclSimpleGrantedAuthority"/>
    </bean>

    <bean id="aclSimpleGrantedAuthority" class="org.springframework.security.core.authority.SimpleGrantedAuthority">
        <constructor-arg name="role" value="Administrators"/>
    </bean>

    <bean name="aclCache" class="org.springframework.security.acls.domain.SpringCacheBasedAclCache">
        <constructor-arg name="aclAuthorizationStrategy" ref="aclAuthorizationStrategy"/>
        <constructor-arg name="permissionGrantingStrategy" ref="aclPermissionGrantingStrategy"/>
        <constructor-arg name="cache">
            <bean factory-bean="aclJCacheManager" factory-method="getCache">
                <constructor-arg name="name" value="aclCache"/>
            </bean>
        </constructor-arg>
    </bean>

    <bean name="aclPermissionGrantingStrategy"
          class="org.springframework.security.acls.domain.DefaultPermissionGrantingStrategy">
        <constructor-arg name="auditLogger" ref="aclAuditLogger"/>
    </bean>

    <bean name="aclJCacheManager" class="org.springframework.cache.jcache.JCacheCacheManager"/>

    <bean name="aclPermissionEvaluator" class="org.springframework.security.acls.AclPermissionEvaluator">
        <constructor-arg name="aclService" ref="aclService"/>
    </bean>
</beans>
