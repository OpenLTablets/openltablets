<?xml version="1.0" encoding="utf-8"?>
<ui:composition
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

    <h:head></h:head>

    <c:set var="contextPath" value="#{facesContext.externalContext.request.contextPath}" />
    <c:set var="sourceModified" value="#{studio.model.sourceModified}" />

    <script type="text/javascript">
        function sourceModified() {
            if (confirm('Project source file was modified.\nClick \'OK\' to reload Studio with changes, and \'Cancel\' to ignore changes.')) {
                top.main.location.href = '#{contextPath}/faces/main.xhtml?reload=reload';
            }
        }
    </script>

    <h:form>
        <a4j:poll id="poll" enabled="#{!sourceModified}" interval="4000"
            oncomplete="#{sourceModified ? 'sourceModified()' : ''}"  render="poll" />
    </h:form>

</ui:composition>
