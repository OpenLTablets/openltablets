<?xml version="1.0" encoding="UTF-8"?>
<html
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

    <c:set var="contextPath" value="#{facesContext.externalContext.request.contextPath}" />
    <c:set var="sourceModified" value="#{studio.model.sourceModified}" />

    <h:head></h:head>

    <h:body>
        <script>
            function sourceModified() {
                if (confirm('Project source file was modified.\nClick \'OK\' to reload WebStudio with changes, and \'Cancel\' to ignore changes.')) {
                    reload();
                }
            }
        </script>

        <a4j:jsFunction name="reload" action="#{mainBean.reload}"
            oncomplete="top.location.href='#{contextPath}'" />

        <h:form>
            <a4j:poll id="poll" enabled="#{!sourceModified}" interval="4000"
                oncomplete="#{sourceModified ? 'sourceModified()' : ''}"  render="poll" />
        </h:form>
    </h:body>

</html>
