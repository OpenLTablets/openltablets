<ui:composition
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:ui="http://java.sun.com/jsf/facelets">

	<rich:modalPanel  id="modalDeleteProject" minHeight="200" minWidth="400" 
		height="200" width="400" zindex="2000">
		<f:facet name="header">
			<h:outputText value="Confirm Delete" />
		</f:facet>

		<f:facet name="controls">
			<h:graphicImage value="/images/modal/close.png" style="cursor:pointer" onclick="closeMDP(false);" />
		</f:facet>

		<h:form id="modalDeleteProjectForm">
		<h:panelGrid
		  styleClass="modalBody"
		  cellpadding="0" cellspacing="0" border="0" 
		  columns="1" columnClasses="modalCol"
		  rowClasses="modalRow1,modalRow2,modalRow3"
		>
			<h:panelGroup styleClass="modalMessage">
				<p id="modalDeleteProject:message">
				Are you sure you want to delete it?
				</p>
			</h:panelGroup>
			
			<rich:separator height="1" />
			
			<h:panelGrid
			  styleClass="modalButtonPanel"
			  cellpadding="0" cellspacing="0" border="0"
			  columns="2" columnClasses="modalButtonCol,modalButtonCol"
			>
				<h:commandButton 
				  styleClass="modalButton" 
				  value="Delete" 
				  onclick="return closeMDP(true);" 
				/>
				<h:commandButton 
				  styleClass="modalButton" 
				  value="Cancel" 
				  onclick="return closeMDP(false);" 
				/>
			</h:panelGrid>
		</h:panelGrid>
		</h:form>
		
	</rich:modalPanel>

	<script>
		var lastMDPEval = null;

		function cutIfStarts(s, text, max) {
			var i;
			
			i = s.indexOf(text);
			if (i > 0 &amp;&amp; i &lt;= max) {
				s = s.substr(i + text.length);
			}
			
			return s;
		}
		
		function cutIfEnds(s, text) {
			var i;
			
			i = s.lastIndexOf(text);
			if ((i + text.length) == s.length) {
				s = s.substr(0, i);
			}
			
			return s;
		}

		function initMDP(from) {
			var s = '' + from.getAttribute('onclick');
			
			if (s.charAt(s.length - 1) == '}') {
				// IE
				s = s.substr(0, s.length - 1);
			} else {
				// FF
			}

			s = cutIfStarts(s, 'return false;', 100);
//			alert(s);
			
			lastMDPEval = s;
		}
		
		function closeMDP(result) {
			Richfaces.hideModalPanel('modalDeleteProject');
			
			if (result) {
				eval("function exe(){" + lastMDPEval + "};exe();");
			}
			return false;
		}
		
		function format(s, param) {
			var place = '{0}';
			
			var i = s.indexOf(place);
			if (i > 0) {
				s = s.substr(0, i) + param + s.substr(i + place.length);
			} else {
				s = s + ' ' + param;
			}
			
			return s;
		}
		
		function initMessage(from, elId, msgFormat, param) {
			var el = document.getElementById(elId);
			var s = (param) ? param : from.innerHTML;
			el.innerHTML = format(msgFormat, s);
		}
		
		function confirmDeleteProject(from, param) {
			initMessage(from, 'modalDeleteProject:message',
			"Are you sure you want to delete the project '{0}'?", param);
		
			initMDP(from);
			Richfaces.showModalPanel('modalDeleteProject');
			return false;
		}
	</script>

</ui:composition>
