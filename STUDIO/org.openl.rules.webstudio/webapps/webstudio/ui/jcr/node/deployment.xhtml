<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.ajax4jsf.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax">

  <t:saveState value="#{deploymentController}" />
  <h:panelGrid columns="1">
    <h:messages />

    <rich:toolBar itemSeparator="line">
      <rich:toolBarGroup style="padding:5px;">
        <h:commandLink action="#{deploymentController.deploy}">
          <h:graphicImage styleClass="actionImage" value="/images/jcr/op_deploy.gif" title="Deploy" />
        </h:commandLink>
      </rich:toolBarGroup>
      <rich:toolBarGroup style="padding:5px;">
        <h:commandLink action="#{deploymentController.save}" rendered="#{deploymentController.checkinable}">
          <h:graphicImage styleClass="actionImage" value="/images/jcr/op_checkin.gif" title="Check in" />
        </h:commandLink>
        <h:commandLink action="#{deploymentController.checkOut}" rendered="#{deploymentController.checkoutable}">
          <h:graphicImage styleClass="actionImage" value="/images/jcr/op_checkout.gif" title="Check out" />
        </h:commandLink>
      </rich:toolBarGroup>
    </rich:toolBar>

    <rich:dataTable value="#{deploymentController.items}" var="item" width="500" onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
      onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'" rowKeyVar="index">
      <f:facet name="header">
        <rich:columnGroup>
          <rich:column>
            <h:outputText value="Selected" />
          </rich:column>
          <rich:column>
            <h:outputText value="Name" />
          </rich:column>
          <rich:column>
            <h:outputText value="Version" />
          </rich:column>
          <rich:column>
            <h:outputText value="Message" />
          </rich:column>
          <rich:column>
            <h:outputText value="Actions" />
          </rich:column>
        </rich:columnGroup>
      </f:facet>

      <rich:column style="text-align:center">
        <h:selectBooleanCheckbox value="#{item.selected}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.name}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.version}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.messages}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:commandLink styleClass="actionButton" action="#{deploymentController.deleteItem}" immediate="true"
          onclick="if(!window.confirm('Really delete project?')) {return false;}">
          <f:param name="key" value="#{index}" />
          <h:graphicImage url="/images/test_neq.gif" styleClass="actionImage" style="vertical-align:bottom;" alt="Delete" title="Delete" />
        </h:commandLink>
        <h:commandLink styleClass="actionLabel" action="#{deploymentController.deleteItem}" immediate="true"
          onclick="if(!window.confirm('Really delete project?')) {return false;}">
          <f:param name="key" value="#{index}" />
          <h:outputText value="Delete" />
        </h:commandLink>
      </rich:column>
    </rich:dataTable>

    <h:panelGroup>
      <h:panelGrid columns="2" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
        <h:commandButton value="Add" styleClass="button" onclick="Richfaces.showModalPanel('addDeployEntry')" type="button"/>
        <h:commandButton value="Open Selected Projects" styleClass="button" action="#{deploymentController.openSelectedProjects}"/>
      </h:panelGrid>
    </h:panelGroup>
  </h:panelGrid>

</ui:composition>