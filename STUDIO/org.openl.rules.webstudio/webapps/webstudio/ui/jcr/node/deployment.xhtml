<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.ajax4jsf.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:c="http://java.sun.com/jstl/core">

  <h:panelGrid columns="1">

    <c:set var="node" value="#{repositoryTreeController.selected.dataBean}"/>

    <h:panelGrid columns="4" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton styleClass="button" value="Deploy" action="#{deploymentController.deploy}"/>
      <h:commandButton styleClass="#{node.opened ? 'button':'disabledButton'}" value="Close" action="#{deploymentController.close}" disabled="#{not node.opened}"/>  
      <h:commandButton styleClass="#{node.checkedOut ? 'disabledButton' : 'button'}" value="Check Out" action="#{deploymentController.checkOut}" disabled="#{node.checkedOut}" />
      <h:commandButton styleClass="#{node.checkedOut ? 'button':'disabledButton'}" value="Check In" action="#{deploymentController.checkIn}" disabled="#{not node.checkedOut}" />
    </h:panelGrid>

    <rich:dataTable value="#{deploymentController.items}" var="item" width="500" onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
      onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'" rowKeyVar="index">
      <f:facet name="header">
        <rich:columnGroup>
          <rich:column>
            <h:outputText value="Selected" />
          </rich:column>
          <rich:column>
            <h:outputText value="Name" />
          </rich:column>
          <rich:column>
            <h:outputText value="Version" />
          </rich:column>
          <rich:column>
            <h:outputText value="Message" />
          </rich:column>
          <rich:column>
            <h:outputText value="Actions" />
          </rich:column>
        </rich:columnGroup>
      </f:facet>

      <rich:column style="text-align:center">
        <h:selectBooleanCheckbox value="#{item.selected}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.name}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.version}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.messages}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:commandLink styleClass="actionButton" action="#{deploymentController.deleteItem}" immediate="true"
          onclick="if(!window.confirm('Are you sure you want to delete the project?')) {return false;}">
          <f:param name="key" value="#{item.name}" />
          <h:graphicImage url="/images/test_neq.gif" styleClass="actionImage" style="vertical-align:bottom;" alt="Delete" title="Delete" />
        </h:commandLink>
      </rich:column>
    </rich:dataTable>

    <h:panelGrid columns="2" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton value="Add Descriptor" styleClass="#{node.checkedOut ? 'button':'disabledButton'}" onclick="showAddDeployEntry()" type="button" disabled="#{not node.checkedOut}"/>
      <h:commandButton value="Open Selected Projects" styleClass="button" action="#{deploymentController.openSelectedProjects}"/>
    </h:panelGrid>
  </h:panelGrid>

</ui:composition>