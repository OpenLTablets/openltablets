<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.ajax4jsf.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax">

  <t:saveState value="#{deploymentController.items}" />
  <t:saveState value="#{deploymentController.projectName}" />

  <h:panelGrid columns="1">
    <h:panelGrid columns="3" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton styleClass="button" value="Deploy" action="#{deploymentController.deploy}"/>
      <h:commandButton styleClass="button" value="Check In" action="#{deploymentController.save}" rendered="#{deploymentController.checkinable}" />
      <h:commandButton styleClass="button" value="Check Out" action="#{deploymentController.checkOut}" rendered="#{deploymentController.checkoutable}" />
    </h:panelGrid>

    <ui:include src="/ui/jcr/messages.xhtml" />

    <rich:dataTable value="#{deploymentController.items}" var="item" width="500" onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
      onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'" rowKeyVar="index">
      <f:facet name="header">
        <rich:columnGroup>
          <rich:column>
            <h:outputText value="Selected" />
          </rich:column>
          <rich:column>
            <h:outputText value="Name" />
          </rich:column>
          <rich:column>
            <h:outputText value="Version" />
          </rich:column>
          <rich:column>
            <h:outputText value="Message" />
          </rich:column>
          <rich:column>
            <h:outputText value="Actions" />
          </rich:column>
        </rich:columnGroup>
      </f:facet>

      <rich:column style="text-align:center">
        <h:selectBooleanCheckbox value="#{item.selected}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.name}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.version}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:outputText value="#{item.messages}" />
      </rich:column>
      <rich:column style="text-align:center">
        <h:commandLink styleClass="actionButton" action="#{deploymentController.deleteItem}" immediate="true"
          onclick="if(!window.confirm('Are you sure you want to delete the project?')) {return false;}">
          <f:param name="key" value="#{index}" />
          <h:graphicImage url="/images/test_neq.gif" styleClass="actionImage" style="vertical-align:bottom;" alt="Delete" title="Delete" />
        </h:commandLink>
      </rich:column>
    </rich:dataTable>

    <h:panelGrid columns="2" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton value="Add Descriptor" styleClass="button" onclick="Richfaces.showModalPanel('addDeployEntry')" type="button"/>
      <h:commandButton value="Open Selected Projects" styleClass="button" action="#{deploymentController.openSelectedProjects}"/>
    </h:panelGrid>
  </h:panelGrid>

</ui:composition>