<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:rich="http://richfaces.ajax4jsf.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets">

  <h:panelGroup rendered="#{repositoryTree.selected.type == 'repository'}">
    <h:panelGrid columns="2" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton styleClass="button" value="Create New Project" onclick="return confirmNewProject();" />
      <h:commandButton styleClass="button" value="Upload Project" onclick="Richfaces.showModalPanel('modalUploadProject'); return false;" />
    </h:panelGrid>

    <rich:tabPanel style="height:400px;">
      <rich:tab label="Projects">
        <ui:include src="/ui/jcr/projects.xhtml" />
      </rich:tab>
    </rich:tabPanel>
  </h:panelGroup>

  <h:panelGroup rendered="#{repositoryTree.selected.type == 'file'}">
    <h:panelGrid columns="2" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton styleClass="button" value="Update" onclick="return confirmUpdateFile();" />
      <h:commandButton styleClass="button" value="Delete" onclick="return confirmDeleteNode();" />
    </h:panelGrid>
  </h:panelGroup>

  <h:panelGroup rendered="#{repositoryTree.selected.type == 'folder'}">
    <h:panelGrid columns="3" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
      <h:commandButton styleClass="button" value="Delete" onclick="return confirmDeleteNode();" />
      <h:commandButton styleClass="button" value="Add Folder" onclick="return confirmNewFolder();" />
      <h:commandButton styleClass="button" value="Add File" onclick="return confirmNewFile();" />
    </h:panelGrid>
  </h:panelGroup>

  <h:panelGroup
    rendered="#{repositoryTree.selected.type == 'project' &amp;&amp; repositoryTree.selected.name != repositoryTree.secondProjectName}">
    <h:panelGroup rendered="#{userSession.selected.dataBean.marked4Deletion}">
      <h:commandButton styleClass="button" value="Undelete" action="undeleteProject"
        onclick="return confirmUndeleteProject(this, '#{repositoryTree.selected.dataBean.name}');" />
      <h:commandButton styleClass="button" value="ERASE" action="eraseProject"
        onclick="return confirmEraseProject(this, '#{repositoryTree.selected.dataBean.name}');" />
    </h:panelGroup>

    <h:panelGroup rendered="#{not userSession.selected.dataBean.marked4Deletion}">
      <h:panelGrid columns="8" styleClass="buttonPanel" cellpadding="4px;" cellspacing="0px;">
        <h:commandButton styleClass="button" value="Open" action="#{repository.openProject}" />
        <h:commandButton styleClass="button" value="Close" action="#{repository.closeProject}" />
        <h:commandButton styleClass="button" value="Check Out" action="#{repository.checkOutProject}" />
        <h:commandButton styleClass="button" value="Check In" action="#{repository.checkInProject}" />
        <h:commandButton styleClass="button" value="Copy" onclick="return confirmCopyProject('#{repositoryTree.selected.dataBean.name}');" />
        <h:commandButton styleClass="button" value="Delete" onclick="return confirmDeleteNode();" />
        <h:commandButton styleClass="button" value="Add Folder" onclick="return confirmNewFolder();" />
        <h:commandButton styleClass="button" value="Add File" onclick="return confirmNewFile();" />
      </h:panelGrid>
    </h:panelGroup>
  </h:panelGroup>

  <h:panelGroup
    rendered="#{repositoryTree.selected.type != 'repository' &amp;&amp; repositoryTree.selected.name != repositoryTree.secondProjectName}">
    <rich:tabPanel switchType="client" style="height:400;">
      <rich:tab label="Properties">
        <h:panelGroup rendered="#{repositoryTree.selected.type == 'file'}">
          <ui:include src="/ui/jcr/node/fileProps.xhtml" />
        </h:panelGroup>
        <h:panelGroup rendered="#{repositoryTree.selected.type == 'folder'}">
          <ui:include src="/ui/jcr/node/folderProps.xhtml" />
        </h:panelGroup>
        <h:panelGroup rendered="#{repositoryTree.selected.type == 'project'}">
          <ui:include src="/ui/jcr/node/projectProps.xhtml" />
        </h:panelGroup>
      </rich:tab>
      <rich:tab label="Versions">
        <ui:include src="/ui/jcr/node/versions.xhtml" />
      </rich:tab>
      <rich:tab label="Elements" rendered="#{repositoryTree.selected.type != 'file'}">
        <ui:include src="/ui/jcr/node/elements.xhtml" />
      </rich:tab>
      <rich:tab label="Dependencies" rendered="#{repositoryTree.selected.type == 'project'}">
        <ui:include src="/ui/jcr/node/dependency.xhtml" />
      </rich:tab>
    </rich:tabPanel>
  </h:panelGroup>

  <h:panelGroup rendered="#{repositoryTree.selected.name == repositoryTree.secondProjectName}">
    <ui:include src="node/deployment.xhtml" />
  </h:panelGroup>

</ui:composition>
