<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:c="http://java.sun.com/jstl/core"    
    template="/facelets/common/choosePropertiesBase.xhtml">
    
    <ui:define name="header">
        <a4j:loadScript src="resource:///js/validation.js" />
        <a4j:loadScript src="resource:///js/validation.js" />
        <a4j:loadScript src="resource:///js/BaseEditor.js" />
        <a4j:loadScript src="resource:///js/BaseTextEditor.js" />
        <a4j:loadScript src="resource:///js/MultiselectEditor.js" />
        <a4j:loadScript src="resource:///js/DropdownEditor.js" />
        <a4j:loadScript src="resource:///js/AjaxHelper.js" />
        <a4j:loadStyle src="resource:///css/multiselect.css" />
    </ui:define>
	<ui:define name="tableTitle">
        <h:messages errorClass="error" infoStyle="color:green" />

    	<c:set var="propertiesManager" value="#{tableCopierWizard.propertiesManager}" />
	    <h:outputText id="technicalName"
	         value="#{tableCopierWizard.tableTechnicalName}" />
	</ui:define>
    <ui:define name="commandButtons">
        <script type="text/javascript">
            var validations = [];
            <a4j:repeat value="#{tableCopierWizard.propertiesManager.properties}" var="prop" binding="#{tableCopierWizard.propsTable}">
                <h:panelGroup rendered="#{not empty prop.constraints.all}">
                    validations.push(<h:outputText value="#{tableCopierWizard.validationJS}" />);
                </h:panelGroup>
            </a4j:repeat>

            function validateAll() {
                var valid = true;
                validations.each(function (v) {
                    valid = valid &amp;&amp; v.validate();
                });
                return valid;
            }
        </script>

			<h:inputHidden value="1" id="step" binding="#{tableCopierWizardManager.hiddenStep}" />
      		<h:commandButton value="Prev" action="#{tableCopierWizardManager.prev}" />
      		<h:commandButton value="Next" action="#{tableCopierWizardManager.next}" onclick="return validateAll();" />
      		<h:commandButton value="Cancel" action="#{tableCopierWizardManager.cancel}" />
    </ui:define>
</ui:composition>
