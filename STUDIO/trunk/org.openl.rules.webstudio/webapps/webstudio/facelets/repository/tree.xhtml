<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets">

  <rich:dataTable cellspacing="0px" styleClass="standard header" width="305px;">
    <f:facet name="header">
      <rich:columnGroup>
        <rich:column>
          <span style="float: left; font-weight: bold; margin-top: 2px;"><h:outputText value="Repository Tree" /></span>

          <span style="float: right;">
            <a4j:status startText="Loading..."/>
            <input id="filterButton" type="button" class="button" value="Filter" onclick="showRepFilterDialog();" />
            <h:commandLink class="actionButton" title="Refresh" action="#{repositoryTreeController.refreshTree}">
              <h:graphicImage url="/webresource/images/refresh.gif" styleClass="actionImage"
                  style="margin-left: 3px" alt="Refresh" />
            </h:commandLink>
          </span>
        </rich:column>
      </rich:columnGroup>
    </f:facet>
  </rich:dataTable>
  <rich:toolTip for="filterButton" showDelay="500">Filter repository tree</rich:toolTip>

  <rich:panel style="width:300px; height:505px; overflow:auto; clear:left;">
    <rich:tree switchType="ajax" ajaxSubmitSelection="true" nodeSelectListener="#{repositoryTreeState.processSelection}"
      reRender="modalDeleteNode, modalCloseProject, modalCheckOutProject, nodeView, modalOpenVersion, modalCheckIn, modalCopyProject, modalCopyDeploymentProject, modalSmartRedeploy, modalExportVersion"
      value="#{repositoryTreeState.root}" treeNodeVar="item" nodeFace="#{item.type}" preserveModel="none"
      adviseNodeSelected="#{repositoryTreeState.adviseNodeSelected}">

      <rich:treeNode type="repository" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="project" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
        <h:outputText value="  [#{item.comments}]" rendered="#{not empty item.comments}"/>
      </rich:treeNode>
      <rich:treeNode type="folder" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="file" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="drepository" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="deployment" icon="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
        <h:outputText value="  [#{item.comments}]" rendered="#{not empty item.comments}"/>
      </rich:treeNode>
    </rich:tree>
  </rich:panel>

</ui:composition>
