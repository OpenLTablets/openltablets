<ui:composition
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:ui="http://java.sun.com/jsf/facelets">

  <rich:dataTable cellspacing="0px" styleClass="standard header" style="width:100%">
    <f:facet name="header">
      <rich:columnGroup>
        <rich:column>
          <span style="float: left; font-weight: bold; margin-top: 2px;">
            <h:outputText value="Repository Tree" />
          </span>

          <span style="float: right;">
            <a4j:status startText="Loading..." />
            <h:button id="filterButton" value="Filter" onclick="showRepFilterDialog();return false;">
              <rich:tooltip showDelay="500">Filter repository tree</rich:tooltip>
            </h:button>
            <h:commandLink title="Refresh" action="#{repositoryTreeController.refreshTree}">
              <h:graphicImage url="/webresource/images/refresh.gif" styleClass="actionImage"
                  style="margin-left: 3px" alt="Refresh" />
            </h:commandLink>
          </span>
        </rich:column>
      </rich:columnGroup>
    </f:facet>
  </rich:dataTable>

  <rich:panel style="width:300px; height:505px; overflow:auto; clear:left;">
    <rich:tree toggleType="ajax" selectionType="ajax" selectionChangeListener="#{repositoryTreeState.processSelection}"
      render="modalDeleteNode modalCloseProject modalCheckOutProject nodeView modalOpenVersion modalCheckIn modalCopyProject modalCopyDeploymentProject modalSmartRedeploy modalExportVersion"
      value="#{repositoryTreeState.root}" var="item" nodeType="#{item.type}">

      <rich:treeNode type="repository" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="project" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
        <h:outputText value="  [#{item.comments}]" rendered="#{not empty item.comments}"/>
      </rich:treeNode>
      <rich:treeNode type="folder" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="file" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="drepository" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
      </rich:treeNode>
      <rich:treeNode type="deployment" iconExpanded="#{item.icon}" iconCollapsed="#{item.icon}" iconLeaf="#{item.iconLeaf}">
        <h:outputText value="#{item.name}" />
        <h:outputText value="  [#{item.comments}]" rendered="#{not empty item.comments}"/>
      </rich:treeNode>
    </rich:tree>
  </rich:panel>

</ui:composition>
