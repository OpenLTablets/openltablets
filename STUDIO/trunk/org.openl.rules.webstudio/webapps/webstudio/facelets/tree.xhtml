<?xml version="1.0" encoding="utf-8"?>
<ui:composition
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    template="/facelets/common/studioBase.xhtml">

    <ui:define name="header">
        <a4j:loadStyle src="resource:///css/tree.css" />
    </ui:define>

    <ui:define name="page">
        <p /><p />

        <h:panelGroup rendered="#{treeBean.projectExists}">
            <!-- Menu BEGIN -->
            <table class="treeMenu">
                <tr>
                    <td>
                        <h:form style="display: inline">
                            <h:selectOneMenu value="#{treeBean.currentSubMode}" onchange="this.form.submit()" >
                                <f:selectItems value="#{treeBean.subModes}" />
                            </h:selectOneMenu>
                        </h:form>
                    </td>
                    <td style="text-align: right;">
                        <h:outputLink value="#{contextPath}/main.jsp?reload=reload" target="top"
                            title="Refresh Project"><img src="webresource/images/refresh.gif" /></h:outputLink>
                        <h:outputLink value="#{contextPath}/faces/facelets/test/runAllTests.xhtml" target="mainFrame"
                            title="Run All Tests" rendered="#{treeBean.projectHasTests}"><img
                            src="webresource/images/test_ok.gif" /></h:outputLink>
                        <h:outputLink value="#{contextPath}/main.jsp?operation=checkIn" styleClass="actionButton"
                            target="top" title="Check in Project" rendered="#{treeBean.projectCheckedOut}"><img
                            src="webresource/images/repository/checkin.gif" /></h:outputLink>
                        <h:outputLink value="#{contextPath}/main.jsp?operation=checkOut" styleClass="actionButton"
                            target="top" title="Check out Project"
                            rendered="#{!treeBean.projectLocalOnly and !treeBean.projectLocked}"><img
                            src="webresource/images/repository/checkout.gif" /></h:outputLink>
                    </td>
                </tr>
            </table>
            <!-- Menu END -->
        </h:panelGroup>

        <rich:modalPanel id="saveWindow" style="display: none;" />

        <p />

        <!-- Tree BEGIN -->
        <rich:tree styleClass="tree" value="#{treeBean.tree}" switchType="client" toggleOnClick="true" var="node"
            nodeFace="#{node.type}" selectedClass="treeNodeSelected" stateAdvisor="#{treeBean.stateManager}">
            <rich:treeNode type="folder"
                icon="#{node.state == 1 ? 'webresource/images/dtree/folder-error.png' : 'webresource/images/dtree/folder.png'}">
                <h:outputText value="#{node.name}" />
            </rich:treeNode>
            <rich:treeNode type="workbook" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/excel-workbook-error.png' : 'webresource/images/excel-workbook.png'}">
                <h:outputText value="#{node.name}" />
            </rich:treeNode>
            <rich:treeNode type="worksheet" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/worksheet-error.png' : 'webresource/images/worksheet.gif'}">
                <h:outputText value="#{node.name}" />
            </rich:treeNode>
            <rich:treeNode type="problem" nodeClass="#{node.active ? '' : 'treeNodeInactive'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.dt" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/dt3-error.png' : (node.state == 2 ? 'webresource/images/dt3-check.png' : 'webresource/images/dt3.png')}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/dt3-error.png' : (node.state == 2 ? 'webresource/images/dt3-check.png' : 'webresource/images/dt3.png')}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.spreadsheet" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/spreadsheet-error.gif' : 'webresource/images/spreadsheet.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/spreadsheet-error.gif' : 'webresource/images/spreadsheet.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.tbasic" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/tbasic-error.gif' : (node.state == 2 ? 'webresource/images/tbasic-check.gif' : 'webresource/images/tbasic.gif')}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/tbasic-error.gif' : (node.state == 2 ? 'webresource/images/tbasic-check.gif' : 'webresource/images/tbasic.gif')}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.columnmatch" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/cmatch-error.gif' : (node.state == 2 ? 'webresource/images/cmatch-check.gif' : 'webresource/images/cmatch.gif')}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/cmatch-error.gif' : (node.state == 2 ? 'webresource/images/cmatch-check.gif' : 'webresource/images/cmatch.gif')}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.data" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/data-error.png' : 'webresource/images/data.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/data-error.png' : 'webresource/images/data.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.datatype" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/dataobject-error.png' : 'webresource/images/dataobject.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/dataobject-error.png' : 'webresource/images/dataobject.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.environment" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/config_obj-error.png' : 'webresource/images/config_obj.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.method" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/method-error.png' : 'webresource/images/method.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/method-error.png' : 'webresource/images/method.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.test.method" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/test_ok-error.gif' : 'webresource/images/test_ok.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/test_ok-error.gif' : 'webresource/images/test_ok.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.run.method" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                icon="#{node.state == 1 ? 'webresource/images/test-error.png' : 'webresource/images/test.gif'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/test-error.png' : 'webresource/images/test.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.properties" nodeClass="#{node.active ? '' : 'treeNodeInactive'}"
                iconLeaf="#{node.state == 1 ? 'webresource/images/data-error.png' : 'webresource/images/data.gif'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
            <rich:treeNode type="table.xls.other" nodeClass="#{node.active ? '' : 'treeNodeInactive'}">
                <h:outputLink value="#{node.url}" title="#{node.title}" target="mainFrame">
                    <h:outputText value="#{node.name}" />
                </h:outputLink>
            </rich:treeNode>
        </rich:tree>
        <!-- Tree END -->

    </ui:define>
</ui:composition>
