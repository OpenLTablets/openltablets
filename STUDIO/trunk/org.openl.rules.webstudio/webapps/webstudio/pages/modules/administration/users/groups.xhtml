<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j">

    <h:form id="groupsForm">
    <table class="table table-striped">
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Privileges</th>
            <th></th>
        </tr>
        <ui:repeat value="#{groupsBean.groups}" var="group">
        <tr>
            <td>#{group.name}</td>
            <td>#{group.description}</td>
            <td>
                <ui:repeat var="authority" value="#{group.privileges}">
                <h:panelGroup class="badge" style="margin-right: 2px"
                    rendered="#{authority.name.startsWith('PRIVILEGE') and authority.name != 'PRIVILEGE_ALL'}">#{authority.displayName}</h:panelGroup>
                <h:panelGroup class="badge badge-info" style="margin-right: 2px"
                    rendered="#{!authority.name.startsWith('PRIVILEGE')}">#{authority.displayName}</h:panelGroup>
                <h:panelGroup class="badge badge-error" style="margin-right: 2px"
                    rendered="#{authority.name == 'PRIVILEGE_ALL'}">#{authority.displayName}</h:panelGroup>
                </ui:repeat>
            </td>
            <td>
                <a4j:commandLink execute="@this" render="@form"
                    action="#{groupsBean.deleteGroup(group.name)}"
                    onclick="if(!window.confirm('Are you sure you want to delete the group?')) {return false;}"
                    title="Delete">
                    <h:graphicImage url="/webresource/images/delete.gif" />
                </a4j:commandLink>
            </td>
        </tr>
        </ui:repeat>
    </table>

    </h:form>

    <br />
    <br />

    <a href="#" onclick="RichFaces.$('modalAddGroup').show()">Add New Group</a>

    <ui:include src="/pages/modules/administration/users/addGroup.xhtml" />

</ui:composition>
