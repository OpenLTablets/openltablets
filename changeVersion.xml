<?xml version="1.0" encoding="UTF-8"?>
<project name="ChangeVersion" basedir="BasePom/org.openl.rules.base-pom" default="help">

    <fileset
            id="openl_version_file"
            dir="${projects_root}"
            includes="DEV/org.openl.core/**/openl.version.properties"
            />

    <target name="change" description="Change Version">
    	<echo>Updating openl.version.properties file</echo>

        <replaceregexp byline="true" description="Updates OpenL version">
            <regexp pattern="openl.version=(.*)"/>
            <substitution expression="openl.version=${version}"/>
            <fileset refid="openl_version_file"/>
        </replaceregexp>   	
    	
        <replaceregexp byline="true" description="Updates build number">
            <regexp pattern="openl.build=(.*)"/>
            <substitution expression="openl.build=${build}"/>
            <fileset refid="openl_version_file"/>
        </replaceregexp>
    </target>

    <target name="help">
        <echo>
            1. Specify 'version' and 'build' properties in release.properties file.
            2. Start this build script with target 'change'

            Note: it does not change version in pom.xml files
            Please, rely on maven tool(s) to do that.

            P.S.
            It fails on purpose after displaying this text.
            Thus, it guarantees that build process uses this script properly.
        </echo>
        <fail message="Script must fail if target is ommitted."/>
    </target>

</project>