<?xml version="1.0"?>

<project name="pre.build" default="build.default">

<target name="build.default">
  <antcall target="build.all">
    <param name="src.dir" value="../templates" />
    <param name="dst.dir" value="./templates" />
  </antcall>
</target>


<target name="build.all">
  <mkdir dir="${dst.dir}" />
  
  <antcall target="copy.project">
    <param name="project.name" value="lang.config"/>
  </antcall>
  
  <antcall target="copy.project">
    <param name="project.name" value="template"/>
  </antcall>

  <antcall target="copy.project">
    <param name="project.name" value="org.openl.examples"/>
  </antcall>

</target>


<target name="copy.project">
  
  <delete dir="${dst.dir}/${project.name}" />

  <copy todir="${dst.dir}/${project.name}" includeemptydirs="yes" overwrite="yes">
    <fileset dir="${src.dir}/${project.name}">
      <exclude name="**/CVS/**" />
      <exclude name="**/classes**" />
    </fileset>
  </copy>

</target>



<target name="project2template">

  <property name="project.name.macro" value="project.name" />

  <antcall target="macro.wrap">
    <param name="macro.dir" value="${dst.dir}/${project.name}"/>
    <param name="macro.token" value="${project.name}"/>
    <param name="macro.value" value="${project.name.macro}"/>
  </antcall>
  
</target>



<target name="macro.wrap">

  <property name="dollar" value="$" />
  <property name="lbrace" value="{" />
  <property name="rbrace" value="}" />

  <replace 
    dir="${macro.dir}" 
    token="${macro.token}" 
    value="${dollar}${lbrace}${macro.value}${rbrace}" />
  
</target>

</project>
